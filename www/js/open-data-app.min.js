$(document).ready(function(){var h=[];if(document.getElementById("map")){var c={center:new google.maps.LatLng(45.423494,-75.697933),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};var a=new google.maps.Map(document.getElementById("map"),c);var d;$(".list > li").each(function(){var m=$(this).find("a").html();var q='<div class="info-window"><strong>'+m+'</strong><a href="skateboardpark/'+$(this).attr("data-id")+'#rate">Rate This!</a></div>';var o=parseFloat($(this).find('meta[itemprop="longitude"]').attr("content"));var p=parseFloat($(this).find('meta[itemprop="latitude"]').attr("content"));var r=new google.maps.LatLng(p,o);h.push({id:$(this).attr("data-id"),lat:p,lng:o});var l=new google.maps.Marker({position:r,map:a,title:m,icon:"/images/marker.png",animation:google.maps.Animation.DROP});function n(s){if(s.preventDefault){s.preventDefault()}if(d){d.close()}d=new google.maps.InfoWindow({content:q});d.open(a,l)}google.maps.event.addListener(l,"click",n);google.maps.event.addDomListener($(this).children("a").get(0),"click",n)})}if(document.getElementById("map2")){var k=parseFloat($(".singlelongi").html());var i=parseFloat($(".singlelat").html());var c={center:new google.maps.LatLng(i,k),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};var a=new google.maps.Map(document.getElementById("map2"),c);var j=new google.maps.LatLng(i,k);var f=new google.maps.Marker({position:j,map:a,title:$("h2").html(),icon:"/images/marker.png",animation:google.maps.Animation.DROP})}var e=$(".rater-usable li");console.log(e);e.on("mouseenter",function(m){var n=$(this).index();for(var l=0;l<n;l++){e.eq(l).addClass("is-rated-hover")}}).on("mouseleave",function(l){e.removeClass("is-rated-hover")});var g;function b(q,r){var t=[],l=h.length,s=new google.maps.LatLng(q,r);if(g){g.setPosition(s)}else{g=new google.maps.Marker({position:s,map:a,title:"You are here.",icon:"/images/new.png",animation:google.maps.Animation.DROP})}a.setCenter(s);var p=new LatLon(q,r);for(var o=0;o<l;o++){t.push({id:h[o].id,distance:parseFloat(p.distanceTo(new LatLon(h[o].lat,h[o].lng)))})}t.sort(function(v,u){return v.distance-u.distance});var n=$(".list");for(var m=0;m<l;m++){$li=n.find('[data-id="'+t[m].id+'"]');$li.find(".distance").html(t[m].distance.toFixed(1)+"km");n.append($li)}}if(navigator.geolocation){$("#submitaddr").click(function(){$("#geo-form").submit()});$("#geo").click(function(){navigator.geolocation.getCurrentPosition(function(l){b(l.coords.latitude,l.coords.longitude)})})}$("#geo-form").on("submit",function(l){l.preventDefault();console.log("form");var m=new google.maps.Geocoder();m.geocode({address:$("#adr").val()+"Ottawa, ON",region:"CA"},function(o,n){if(n==google.maps.GeocoderStatus.OK){b(o[0].geometry.location.lat(),o[0].geometry.location.lng())}})})});